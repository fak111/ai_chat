# A宝 - 产品需求文档 (PRD)

## 文档信息

| 项目 | 内容 |
|------|------|
| 版本 | v1.0 |
| 创建日期 | 2026-02-05 |
| 状态 | 草稿 |

## 1. 产品概述

### 1.1 产品背景

当前市场上的 AI 聊天应用主要以单人与 AI 对话为主，缺乏将 AI 融入熟人社交场景的产品。A宝 旨在填补这一空白，让用户能够在群聊中与朋友和 AI 一起交流，获得更丰富的社交体验。

### 1.2 产品定位

| 项目 | 内容 |
|------|------|
| 产品名称 | A宝 |
| 一句话定位 | AI群聊应用 - 让每群人都能AI聊天 |
| 目标用户 | 熟人网络用户群体 |
| 核心价值 | 将 AI 助手融入熟人群聊，让每个群都拥有智能伙伴 |
| 差异化优势 | 不同于单人 AI 对话，A宝 专注于群聊场景的 AI 交互 |

### 1.3 产品目标

| 目标 | 指标 | 衡量方式 |
|------|------|----------|
| MVP 验证 | 完成核心功能开发 | 群聊 + 邮箱登录功能可用 |
| 用户获取 | 待定 | 待补充 |
| 用户留存 | 待定 | 待补充 |

## 2. 用户故事

### 2.1 用户角色定义

<!-- MODIFIED: 移除"群主"角色，群聊采用扁平化结构，所有成员权限平等 -->
| 角色 | 描述 | 核心目标 | 痛点 |
|------|------|----------|------|
| 群成员 | 熟人网络中的成员，希望与朋友交流 | 在群聊中与朋友和 AI 互动，可创建/加入群聊并分享邀请 | 现有 AI 应用只能单人使用，无法与朋友共享 AI 体验 |

### 2.2 用户故事列表

#### P0 - 核心故事

<!-- MODIFIED: US-003 移除"群主"改为"群成员"；新增 US-007 引用AI回复继续对话 -->
| ID | 用户故事 | 验收标准 |
|----|----------|----------|
| US-001 | 作为群成员，我想要使用邮箱注册账号，以便快速开始使用应用 | 1. 可输入邮箱地址 2. 收到验证邮件 3. 完成验证后账号创建成功 |
| US-002 | 作为群成员，我想要使用邮箱登录应用，以便访问我的账号 | 1. 输入邮箱和密码 2. 验证成功后进入主页 3. 登录状态保持 |
| US-003 | 作为群成员，我想要创建一个群聊（派），以便邀请朋友加入 | 1. 点击创建按钮 2. 设置群名称 3. 群聊创建成功并显示在列表 |
| US-004 | 作为群成员，我想要通过邀请码加入群聊，以便与朋友交流 | 1. 输入邀请码 2. 加入成功后群聊显示在列表 |
| US-005 | 作为群成员，我想要在群聊中发送消息，以便与朋友交流 | 1. 输入文字消息 2. 点击发送 3. 消息显示在聊天记录 |
| US-006 | 作为群成员，我想要在群聊中 @AI 获得回复，以便获取信息或建议 | 1. 输入 @AI名称 + 问题 2. AI 自动回复 3. 所有群成员可见 AI 回复 |
| US-007 | 作为群成员，我想要引用 AI 的回复继续对话，以便深入探讨某个问题 | 1. 长按/点击 AI 回复选择引用 2. 输入追问内容 3. AI 基于上下文继续回复 |

#### P1 - 重要故事

<!-- MODIFIED: US-008 改为所有群成员可分享邀请码；删除 AI 朗读功能 -->
| ID | 用户故事 | 验收标准 |
|----|----------|----------|
| US-008 | 作为群成员，我想要获取并分享群邀请码，以便邀请朋友加入 | 1. 进入群设置 2. 获取邀请码 3. 可复制分享 |
| US-009 | 作为群成员，我想要查看群聊历史消息，以便了解之前的对话 | 1. 进入群聊 2. 向上滚动查看历史 3. 消息按时间顺序显示 |

#### P2 - 次要故事

<!-- MODIFIED: 删除消息收藏功能 -->
| ID | 用户故事 | 验收标准 |
|----|----------|----------|
| US-010 | 作为群成员，我想要设置主题色，以便个性化界面 | 1. 进入设置 2. 选择主题色 3. 界面颜色更新 |

### 2.3 用户旅程

**核心旅程：新用户加入群聊并与 AI 互动**

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  下载应用   │ ──▶ │  邮箱注册   │ ──▶ │  加入群聊   │ ──▶ │  群内互动   │
│             │     │             │     │  (邀请码)   │     │  (@AI)      │
└─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
   期待与朋友          快速完成注册        成功加入朋友       与朋友和AI
   一起聊天            无需复杂信息        创建的群聊         愉快交流
```

<!-- MODIFIED: 移除"群主"概念，改为"用户" -->
**核心旅程：用户创建群聊并邀请朋友**

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  登录应用   │ ──▶ │  创建群聊   │ ──▶ │  获取邀请码 │ ──▶ │  分享邀请   │
│             │     │  (派)       │     │             │     │             │
└─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘
        │                   │                   │                   │
        ▼                   ▼                   ▼                   ▼
   想创建一个          设置群名称           复制邀请码         朋友加入后
   有AI的群            群聊创建成功         准备分享           开始聊天
```

## 3. 功能需求

### 3.1 功能架构

<!-- MODIFIED: 删除 AI 朗读，新增引用 AI 回复继续对话；删除消息收藏 -->
```
A宝
├── 用户系统
│   ├── 邮箱注册
│   ├── 邮箱登录
│   └── 登录态管理
├── 群聊系统（派）
│   ├── 创建群聊
│   ├── 加入群聊（邀请码）
│   ├── 群聊列表
│   ├── 群聊消息
│   │   ├── 发送消息
│   │   ├── 接收消息
│   │   └── 历史消息
│   └── 群设置
│       ├── 群信息
│       └── 邀请码分享（所有成员可用）
├── AI 系统
│   ├── AI 群成员
│   ├── @AI 触发回复
│   └── 引用 AI 回复继续对话（P0）
└── 设置
    ├── 主题色（P2）
    └── 消息中心
```

### 3.2 功能详情

#### 3.2.1 用户系统

| 功能点 | 描述 | 关联用户故事 | 优先级 | 验收标准 |
|--------|------|--------------|--------|----------|
| 邮箱注册 | 用户使用邮箱地址注册账号 | US-001 | P0 | 输入有效邮箱，收到验证邮件，点击验证链接后账号创建成功 |
| 邮箱登录 | 用户使用邮箱和密码登录 | US-002 | P0 | 输入正确邮箱密码后成功登录，错误时显示提示 |
| 登录态管理 | 保持用户登录状态 | US-002 | P0 | 关闭应用后重新打开无需再次登录 |

#### 3.2.2 群聊系统（派）

| 功能点 | 描述 | 关联用户故事 | 优先级 | 验收标准 |
|--------|------|--------------|--------|----------|
| 创建群聊 | 用户创建新的群聊空间 | US-003 | P0 | 设置群名称后创建成功，群聊显示在列表 |
| 加入群聊 | 通过邀请码加入已有群聊 | US-004 | P0 | 输入有效邀请码后成功加入，群聊显示在列表 |
| 群聊列表 | 显示用户加入的所有群聊 | US-003, US-004 | P0 | 按最近活跃时间排序显示群聊列表 |
| 发送消息 | 在群聊中发送文字消息 | US-005 | P0 | 输入文字点击发送后，消息显示在聊天记录 |
| 接收消息 | 实时接收群内其他成员消息 | US-005 | P0 | 群内有新消息时实时显示 |
| 历史消息 | 查看群聊历史记录 | US-009 | P1 | 向上滚动可加载更多历史消息 |
<!-- MODIFIED: 邀请码分享改为所有群成员可用 -->
| 邀请码分享 | 所有群成员均可获取和分享群邀请码 | US-008 | P1 | 在群设置中可查看邀请码并复制分享 |

#### 3.2.3 AI 系统

<!-- MODIFIED: 删除 AI 朗读和音色设置，新增引用 AI 回复继续对话 -->
| 功能点 | 描述 | 关联用户故事 | 优先级 | 验收标准 |
|--------|------|--------------|--------|----------|
| AI 群成员 | 每个群聊包含 AI 成员 | US-006 | P0 | 群聊中显示 AI 成员，有独特标识 |
| @AI 触发回复 | 用户 @AI 后 AI 自动回复 | US-006 | P0 | 发送 @AI + 问题后，AI 在群内回复 |
| 引用 AI 回复 | 用户可引用 AI 回复继续对话 | US-007 | P0 | 选择 AI 回复后可引用追问，AI 基于上下文继续回复 |

#### 3.2.4 设置

<!-- MODIFIED: 删除消息收藏功能 -->
| 功能点 | 描述 | 关联用户故事 | 优先级 | 验收标准 |
|--------|------|--------------|--------|----------|
| 主题色 | 设置应用主题颜色 | US-010 | P2 | 选择颜色后界面配色更新 |
| 消息中心 | 查看系统通知 | - | P2 | 显示系统通知和消息提醒 |

## 4. 非功能需求

### 4.1 性能需求

| 指标 | 要求 | 说明 |
|------|------|------|
| 消息发送延迟 | < 1 秒 | 用户发送消息到显示在聊天记录的时间 |
| AI 响应时间 | < 5 秒 | 用户 @AI 到 AI 开始回复的时间 |
| 应用启动时间 | < 3 秒 | 冷启动到主页可交互的时间 |
| 并发用户数 | 待定 | MVP 阶段待评估 |

### 4.2 安全需求

| 需求 | 说明 |
|------|------|
| 数据传输加密 | 使用 HTTPS 加密所有网络通信 |
| 密码存储 | 密码加盐哈希存储，不明文保存 |
| 登录安全 | 支持登录失败次数限制，防止暴力破解 |
| 邀请码安全 | 邀请码具有时效性或使用次数限制（待定） |

### 4.3 兼容性需求

| 平台/环境 | 支持版本 |
|-----------|----------|
| Android | 待定（建议 Android 8.0+） |
| iOS | 后续规划，MVP 不支持 |

### 4.4 可用性需求

| 需求 | 说明 |
|------|------|
| 服务可用性 | 待定 |
| 故障恢复 | 待定 |
| 离线支持 | 待定（建议支持查看历史消息） |

## 5. 数据需求

### 5.1 数据模型

<!-- MODIFIED: 删除 owner_id（无群主概念），GroupMember 移除 role 字段 -->
```
┌──────────────┐       ┌──────────────┐       ┌──────────────┐
│    User      │       │    Group     │       │   Message    │
│   (用户)     │       │   (群聊)     │       │   (消息)     │
├──────────────┤       ├──────────────┤       ├──────────────┤
│ id           │       │ id           │       │ id           │
│ email        │ 1───n │ name         │ 1───n │ content      │
│ password     │◀─────▶│ invite_code  │◀─────▶│ sender_id    │
│ nickname     │       │ created_at   │       │ group_id     │
│ avatar       │       └──────────────┘       │ created_at   │
│ created_at   │              │               │ type         │
└──────────────┘              │               │ reply_to_id  │
                              │ 1             └──────────────┘
                              │
                              ▼ n
                    ┌──────────────┐
                    │ GroupMember  │
                    │ (群成员)     │
                    ├──────────────┤
                    │ group_id     │
                    │ user_id      │
                    │ joined_at    │
                    └──────────────┘
```

### 5.2 数据规范

| 字段 | 类型 | 说明 | 校验规则 |
|------|------|------|----------|
| email | String | 用户邮箱 | 有效邮箱格式 |
| password | String | 用户密码 | 最少 8 位，包含字母和数字（待定） |
| nickname | String | 用户昵称 | 1-20 字符 |
| group_name | String | 群聊名称 | 1-50 字符 |
| invite_code | String | 邀请码 | 唯一，6-10 位字母数字（待定） |
| message_content | String | 消息内容 | 最大长度待定 |

## 6. 接口需求

### 6.1 外部接口

<!-- MODIFIED: 删除语音合成接口 -->
| 接口 | 用途 | 提供方 |
|------|------|--------|
| 邮箱服务 | 发送验证邮件 | 待定（如 SendGrid, AWS SES） |
| AI 服务 | 提供 AI 对话能力 | 待定 |

### 6.2 内部接口

待开发计划阶段详细定义 API 接口规范。

## 7. 约束与依赖

### 7.1 技术约束

| 约束 | 说明 | 影响 |
|------|------|------|
| MVP 仅支持 Android | 首期只开发 Android 版本 | iOS 用户无法使用 |
| 需要网络连接 | 核心功能依赖网络 | 离线功能受限 |

### 7.2 业务约束

| 约束 | 说明 |
|------|------|
| 熟人网络定位 | 仅支持邀请码加入，不提供公开搜索 |
| MVP 范围 | 不包含联系人管理、单聊等功能 |

### 7.3 外部依赖

| 依赖 | 说明 | 风险 |
|------|------|------|
| 邮箱服务商 | 依赖第三方发送验证邮件 | 需选择可靠服务商 |
| AI 服务 | 依赖 AI 模型提供对话能力 | 需考虑成本和响应速度 |

## 8. 里程碑规划

<!-- MODIFIED: 删除 AI 朗读、音色设置、消息收藏；新增引用AI回复 -->
```
Phase 1               Phase 2               Phase 3
   │                     │                     │
   ▼                     ▼                     ▼
┌────────┐          ┌────────┐          ┌────────┐
│  MVP   │  ────▶   │  v1.1  │  ────▶   │  v2.0  │
│  核心  │          │  增强  │          │  扩展  │
└────────┘          └────────┘          └────────┘
   P0功能              P1功能              P2功能
   邮箱登录            历史消息            主题色
   创建/加入群聊       邀请码分享          iOS版本
   群聊消息
   @AI回复
   引用AI继续对话
```

| 阶段 | 目标 | 交付物 |
|------|------|--------|
| Phase 1 (MVP) | 核心功能可用 | 可发布的 Android 应用 |
| Phase 2 | 功能增强 | 历史消息优化、邀请码分享 |
| Phase 3 | 平台扩展 | iOS 版本、主题色 |

## 9. 风险评估

| 风险 | 可能性 | 影响 | 应对措施 |
|------|--------|------|----------|
| AI 响应延迟 | 中 | 中 | 显示加载状态，优化 AI 服务选型 |
| 邮箱验证到达率 | 中 | 高 | 选择可靠邮箱服务商，支持重发 |
| 用户增长缓慢 | 中 | 中 | 优化邀请分享流程，降低加入门槛 |
| AI 成本过高 | 低 | 高 | 设置合理的调用频率限制 |

## 附录

### A. 术语表

<!-- MODIFIED: 更新邀请码定义，移除"群主" -->
| 术语 | 定义 |
|------|------|
| 派 | 群聊的产品化名称，即一个多人聊天空间 |
| A宝 | 产品名称，AI群聊应用 |
| @AI | 在消息中 @AI 名称来触发 AI 回复的交互方式 |
| 邀请码 | 加入群聊所需的唯一代码，所有群成员均可获取和分享 |
| 引用回复 | 选中 AI 回复后继续追问，AI 基于上下文继续对话 |

### B. 参考文档

- RequirementsDoc.md
- UI 参考图：doc/ui_inference/
  - show_page.png - 群聊列表页
  - content.png - 聊天内容页
  - setting.png - 群设置页
