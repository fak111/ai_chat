# A宝 - 任务列表

## 文档信息

| 项目 | 内容 |
|------|------|
| 版本 | v1.0 |
| 创建日期 | 2026-02-05 |
| 来源文档 | UIDesign.md, DevelopmentPlan.md |

## 1. 任务总览

| 统计项 | 数量 |
|--------|------|
| 总任务数 | 30 |
| P0 任务 | 17 |
| P1 任务 | 6 |
| P2 任务 | 7 |

## 2. Phase 1 任务（MVP 核心功能）

### 2.1 基础架构

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-001 | 项目初始化 | 创建 Flutter 项目、Spring Boot 项目结构 | P0 | - | Flutter 项目可运行；Spring Boot 项目可启动；代码仓库初始化完成 |
| T-002 | 基础设施搭建 | Docker 环境、CI/CD 配置、开发环境搭建 | P0 | T-001 | Docker 容器可构建运行；CI 流水线可执行；开发环境文档完善 |
| T-003 | 数据库设计实现 | 设计并创建 users、groups、messages、group_members 表 | P0 | T-001 | 表结构符合 ER 图设计；索引创建完成；Supabase 连接测试通过 |

### 2.2 用户系统

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-004 | 邮箱注册后端 | 实现注册接口、邮箱验证、密码 BCrypt 加密 | P0 | T-003 | POST /api/auth/register 可用；验证邮件可发送（Resend）；密码哈希存储 |
| T-005 | 邮箱登录后端 | 实现登录接口、JWT Token 生成和验证 | P0 | T-004 | POST /api/auth/login 可用；JWT Token 正确生成；登录失败限制生效 |
| T-006 | 登录态管理 | Token 刷新、自动登录、登出接口 | P0 | T-005 | POST /api/auth/refresh 可用；Token 过期正确处理；登出清除 Token |
| T-007 | 用户系统前端 | 实现 P-002 登录页、P-003 注册页、P-004 邮箱验证页 | P0 | T-006 | 页面 UI 符合设计稿；表单校验完整；登录态本地持久化 |

### 2.3 群聊系统

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-008 | 群聊管理后端 | 创建群聊、加入群聊、群聊列表接口 | P0 | T-006 | POST /api/groups 可创建群聊并生成邀请码；POST /api/groups/join 可加入；GET /api/groups 返回用户群聊列表 |
| T-009 | WebSocket 服务 | 实现 WebSocket 连接管理、消息广播、心跳机制 | P0 | T-008 | WebSocket 连接稳定；消息实时推送延迟 <1秒；断线自动重连 |
| T-010 | 消息收发后端 | 消息存储到 PostgreSQL、消息推送、消息查询 | P0 | T-009 | 消息正确存储；WebSocket 广播到群成员；消息类型区分（用户/AI） |
| T-011 | 群聊系统前端 | 实现 P-005 群聊列表页、P-006 聊天页、P-008 创建群聊页、P-009 加入群聊页 | P0 | T-010 | 页面 UI 符合设计稿；群聊列表按活跃时间排序；消息实时收发；未读角标显示 |

### 2.4 AI 系统

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-012 | AI 服务集成 | 对接 DeepSeek API，实现调用封装和重试机制 | P0 | T-003 | DeepSeek API 调用成功；超时 30秒正确处理；错误降级友好提示 |
| T-013 | AI 触发逻辑 | @AI 检测、上下文构建、AI 回复生成 | P0 | T-012, T-010 | @AI/@ai/@Ai 变体均可触发；AI 响应 <5秒；限流 10次/分钟/用户 |
| T-014 | 引用回复逻辑 | 引用消息解析、上下文拼接（直接查 PostgreSQL） | P0 | T-013 | 引用 AI 回复时上下文正确拼接；AI 基于引用内容继续对话 |
| T-015 | AI 交互前端 | @AI 输入触发、AI 消息特殊样式、引用组件 | P0 | T-014, T-011 | @ 触发弹出 AI 选择；AI 消息有 ✨ 标识；长按消息可引用；"AI正在思考..."加载态 |

### 2.5 测试与发布

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-016 | 集成测试 | 端到端测试、性能测试、安全测试 | P0 | T-015 | 核心流程测试通过；消息延迟 <1秒；AI 响应 <5秒；无明显安全漏洞 |
| T-017 | Android 发布 | APK 打包签名、上架 Google Play | P0 | T-016 | APK 可正常安装运行；Google Play 审核通过；版本号 v1.0.0 |

## 3. Phase 2 任务（功能增强）

### 3.1 历史消息

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-018 | 历史消息后端 | 分页查询接口、游标分页优化 | P1 | T-017 | GET /api/groups/{id}/messages 支持分页；每页 20 条；响应 <500ms |
| T-019 | 历史消息前端 | 上滑加载更多、加载状态、日期分隔符 | P1 | T-018 | 滚动到顶部触发加载；显示加载动画；历史消息按日期分组 |

### 3.2 邀请码功能

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-020 | 邀请码功能后端 | 邀请码生成优化、有效期管理（可选） | P1 | T-017 | GET /api/groups/{id}/invite 返回邀请码；邀请码唯一性保证 |
| T-021 | 邀请码功能前端 | 实现 P-007 群设置页、邀请码展示、复制和分享 | P1 | T-020 | 页面 UI 符合设计稿；复制到剪贴板成功提示；系统分享面板可调起 |

### 3.3 性能优化

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-022 | 性能优化 | Caffeine 本地缓存、消息加载优化、启动优化 | P1 | T-019, T-021 | 应用启动 <3秒；消息列表滚动流畅；Redis 日请求量 <500 |
| T-023 | v1.1 发布 | 版本更新发布 | P1 | T-022 | APK 更新发布；版本号 v1.1.0；更新日志完善 |

## 4. Phase 3 任务（平台扩展）

### 4.1 iOS 适配

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-024 | iOS 适配 | Flutter iOS 构建、测试、证书配置 | P2 | T-023 | iOS 模拟器运行正常；真机测试通过；符合 Apple 设计规范 |

### 4.2 主题色设置

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-025 | 主题色后端 | 主题配置存储接口 | P2 | T-023 | PUT /api/users/settings 可保存主题配置；配置持久化 |
| T-026 | 主题色前端 | P-010 个人设置页主题选择、实时切换 | P2 | T-025 | 提供预设主题色选项；切换后界面实时更新；重启后主题保持 |

### 4.3 消息中心

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-027 | 消息中心后端 | 系统通知存储、查询接口 | P2 | T-023 | GET /api/notifications 返回通知列表；支持分页 |
| T-028 | 消息中心前端 | 通知列表页面、未读标记 | P2 | T-027 | 通知列表按时间倒序；未读通知高亮显示；点击标记已读 |

### 4.4 发布

| ID | 任务 | 描述 | 优先级 | 依赖 | 验收标准 |
|----|------|------|--------|------|----------|
| T-029 | iOS 发布 | 上架 App Store | P2 | T-024, T-026, T-028 | App Store 审核通过；版本号 v2.0.0 |
| T-030 | Android v2.0 发布 | Android 2.0 版本发布 | P2 | T-026, T-028 | Google Play 更新发布；版本号 v2.0.0 |

## 5. 任务依赖图

```
Phase 1 (MVP):
T-001 (项目初始化)
  ├── T-002 (基础设施)
  └── T-003 (数据库设计)
        ├── T-004 (邮箱注册后端)
        │     └── T-005 (邮箱登录后端)
        │           └── T-006 (登录态管理)
        │                 ├── T-007 (用户系统前端)
        │                 └── T-008 (群聊管理后端)
        │                       └── T-009 (WebSocket)
        │                             └── T-010 (消息收发后端)
        │                                   └── T-011 (群聊系统前端)
        │                                         └── T-015 (AI交互前端)
        │                                               └── T-016 (集成测试)
        │                                                     └── T-017 (Android发布)
        └── T-012 (AI服务集成)
              └── T-013 (AI触发逻辑)
                    └── T-014 (引用回复逻辑)

Phase 2 (功能增强):
T-017 (Android发布)
  ├── T-018 (历史消息后端)
  │     └── T-019 (历史消息前端)
  └── T-020 (邀请码后端)
        └── T-021 (邀请码前端)
              └── T-022 (性能优化)
                    └── T-023 (v1.1发布)

Phase 3 (平台扩展):
T-023 (v1.1发布)
  ├── T-024 (iOS适配) ─────────────────────┐
  ├── T-025 (主题色后端)                    │
  │     └── T-026 (主题色前端) ──────────┐  │
  └── T-027 (消息中心后端)               │  │
        └── T-028 (消息中心前端) ────────┼──┤
                                         │  │
                                         ▼  ▼
                                    T-030  T-029
                                 (Android) (iOS)
```

## 6. 页面-任务映射

| 页面ID | 页面名称 | 关联任务 | 优先级 |
|--------|----------|----------|--------|
| P-001 | 启动页 | T-007 | P0 |
| P-002 | 登录页 | T-007 | P0 |
| P-003 | 注册页 | T-007 | P0 |
| P-004 | 邮箱验证页 | T-007 | P0 |
| P-005 | 群聊列表页 | T-011 | P0 |
| P-006 | 聊天页 | T-011, T-015 | P0 |
| P-007 | 群设置页 | T-021 | P1 |
| P-008 | 创建群聊页 | T-011 | P0 |
| P-009 | 加入群聊页 | T-011 | P0 |
| P-010 | 个人设置页 | T-026, T-028 | P2 |

## 7. 功能-任务映射

| 功能ID | 功能名称 | 关联任务 | 优先级 |
|--------|----------|----------|--------|
| F-001 | 邮箱注册 | T-004, T-007 | P0 |
| F-002 | 邮箱登录 | T-005, T-007 | P0 |
| F-003 | 登录态管理 | T-006, T-007 | P0 |
| F-004 | 创建群聊 | T-008, T-011 | P0 |
| F-005 | 加入群聊 | T-008, T-011 | P0 |
| F-006 | 群聊列表 | T-008, T-011 | P0 |
| F-007 | 发送消息 | T-009, T-010, T-011 | P0 |
| F-008 | 接收消息 | T-009, T-010, T-011 | P0 |
| F-009 | 历史消息 | T-018, T-019 | P1 |
| F-010 | 邀请码分享 | T-020, T-021 | P1 |
| F-011 | AI群成员 | T-012, T-015 | P0 |
| F-012 | @AI触发回复 | T-013, T-015 | P0 |
| F-013 | 引用AI回复 | T-014, T-015 | P0 |
| F-014 | 主题色 | T-025, T-026 | P2 |
| F-015 | 消息中心 | T-027, T-028 | P2 |

## 8. 执行检查清单

### Phase 1 (MVP)

- [ ] T-001: 项目初始化
- [ ] T-002: 基础设施搭建
- [ ] T-003: 数据库设计实现
- [ ] T-004: 邮箱注册后端
- [ ] T-005: 邮箱登录后端
- [ ] T-006: 登录态管理
- [ ] T-007: 用户系统前端
- [ ] T-008: 群聊管理后端
- [ ] T-009: WebSocket 服务
- [ ] T-010: 消息收发后端
- [ ] T-011: 群聊系统前端
- [ ] T-012: AI 服务集成
- [ ] T-013: AI 触发逻辑
- [ ] T-014: 引用回复逻辑
- [ ] T-015: AI 交互前端
- [ ] T-016: 集成测试
- [ ] T-017: Android 发布

### Phase 2 (功能增强)

- [ ] T-018: 历史消息后端
- [ ] T-019: 历史消息前端
- [ ] T-020: 邀请码功能后端
- [ ] T-021: 邀请码功能前端
- [ ] T-022: 性能优化
- [ ] T-023: v1.1 发布

### Phase 3 (平台扩展)

- [ ] T-024: iOS 适配
- [ ] T-025: 主题色后端
- [ ] T-026: 主题色前端
- [ ] T-027: 消息中心后端
- [ ] T-028: 消息中心前端
- [ ] T-029: iOS 发布
- [ ] T-030: Android v2.0 发布
